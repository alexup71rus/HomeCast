# HomeCast Web Server

–í–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏—ë–º–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∏–¥–µ–æ –ø–æ—Ç–æ–∫–∞ —Å Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üé• –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π —ç–∫—Ä–∞–Ω–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üåê WebRTC –¥–ª—è –Ω–∏–∑–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
- üì± Fallback –Ω–∞ WebSocket + Canvas –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- üìä –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ FPS –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- üíª –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install
```

## –ó–∞–ø—É—Å–∫

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å auto-reload)
```bash
npm run dev
```

### –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º
```bash
npm start
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (server.js)
- Express —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–∑–¥–∞—á–∏ —Å—Ç–∞—Ç–∏–∫–∏
- Socket.io –¥–ª—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∏–º–∞–º–∏ –∏ –∑—Ä–∏—Ç–µ–ª—è–º–∏
- WebRTC —Å–∏–≥–Ω–∞–ª–∏–Ω–≥

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å (public/)
- **index.html** - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- **viewer.js** - –ª–æ–≥–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç—Ä–∏–º–æ–≤
- **styles.css** - —Å—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

## API –°–æ–±—ã—Ç–∏—è (Socket.io)

### –û—Ç Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É:
- `streamer-join` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–∏–º–µ—Ä–∞
- `video-frame` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ —Ñ—Ä–µ–π–º–∞ (fallback)
- `offer` - WebRTC offer (—Å `viewerId`)
- `ice-candidate` - ICE –∫–∞–Ω–¥–∏–¥–∞—Ç (—Å `viewerId`)

### –û—Ç –≤–µ–±-–∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É:
- `viewer-join` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑—Ä–∏—Ç–µ–ª—è
- `get-streams` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∏–º–æ–≤
- `answer` - WebRTC answer (—Å `viewerId`)
- `ice-candidate` - ICE –∫–∞–Ω–¥–∏–¥–∞—Ç (—Å `viewerId`)

### –û—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫ –∫–ª–∏–µ–Ω—Ç–∞–º:
- `streams-update` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∏–º–æ–≤
- `viewer-ready` - –∑—Ä–∏—Ç–µ–ª—å –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `viewerId`)
- `viewer-joined` - –Ω–æ–≤—ã–π –∑—Ä–∏—Ç–µ–ª—å –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è (–¥–ª—è —Å—Ç—Ä–∏–º–µ—Ä–∞)
- `viewer-left` - –∑—Ä–∏—Ç–µ–ª—å –æ—Ç–∫–ª—é—á–∏–ª—Å—è (–¥–ª—è —Å—Ç—Ä–∏–º–µ—Ä–∞)
- `stream-ended` - —Å—Ç—Ä–∏–º –∑–∞–≤–µ—Ä—à—ë–Ω
- `offer` - WebRTC offer (–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑—Ä–∏—Ç–µ–ª—è)
- `answer` - WebRTC answer (–æ—Ç –∑—Ä–∏—Ç–µ–ª—è)
- `ice-candidate` - ICE –∫–∞–Ω–¥–∏–¥–∞—Ç (–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ `viewerId`)
- `video-frame` - –≤–∏–¥–µ–æ —Ñ—Ä–µ–π–º (fallback —Ä–µ–∂–∏–º)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 3000. –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
PORT=8080 npm start
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 14+
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WebRTC

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
2. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å —Å—Ç—Ä–∏–º–æ–≤
3. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
4. –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–æ–º –ø–æ—Ç–æ–∫–∞
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å chat –º–µ–∂–¥—É —Å—Ç—Ä–∏–º–µ—Ä–æ–º –∏ –∑—Ä–∏—Ç–µ–ª—è–º–∏
